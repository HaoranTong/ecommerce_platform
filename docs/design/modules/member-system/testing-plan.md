# ä¼šå‘˜ç³»ç»Ÿæ¨¡å— - æµ‹è¯•è®¡åˆ’æ–‡æ¡£

ğŸ“… **åˆ›å»ºæ—¥æœŸ**: 2025-09-17  
ğŸ‘¤ **æµ‹è¯•è´Ÿè´£äºº**: æµ‹è¯•å·¥ç¨‹å¸ˆ  
âœ… **è¯„å®¡çŠ¶æ€**: è®¾è®¡ä¸­  
ğŸ”„ **æœ€åæ›´æ–°**: 2025-09-17  

## æµ‹è¯•æ¦‚è¿°

### æµ‹è¯•ç›®æ ‡
- éªŒè¯ä¼šå‘˜ç³»ç»Ÿæ‰€æœ‰åŠŸèƒ½æ¨¡å—çš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§
- ç¡®ä¿ç§¯åˆ†è®¡ç®—ã€ç­‰çº§å‡çº§ã€æƒç›Šå‘æ”¾çš„å‡†ç¡®æ€§
- éªŒè¯ç³»ç»Ÿåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½è¡¨ç°
- ç¡®ä¿æ•°æ®ä¸€è‡´æ€§å’Œå®‰å…¨æ€§è¦æ±‚
- éªŒè¯ä¸å…¶ä»–æ¨¡å—çš„é›†æˆåŠŸèƒ½

### æµ‹è¯•ç­–ç•¥
- **å•å…ƒæµ‹è¯•**: è¦†ç›–æ‰€æœ‰æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œä»£ç è¦†ç›–ç‡â‰¥90%
- **é›†æˆæµ‹è¯•**: éªŒè¯æ¨¡å—é—´äº¤äº’å’Œæ•°æ®åº“æ“ä½œ
- **æ¥å£æµ‹è¯•**: ç¡®ä¿APIæ¥å£çš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§
- **æ€§èƒ½æµ‹è¯•**: éªŒè¯ç³»ç»Ÿè´Ÿè½½èƒ½åŠ›å’Œå“åº”æ—¶é—´
- **å®‰å…¨æµ‹è¯•**: éªŒè¯æƒé™æ§åˆ¶å’Œæ•°æ®å®‰å…¨

### æµ‹è¯•ç¯å¢ƒ
- **å¼€å‘ç¯å¢ƒ**: åŠŸèƒ½å¼€å‘å’ŒåŸºç¡€æµ‹è¯•
- **æµ‹è¯•ç¯å¢ƒ**: å®Œæ•´åŠŸèƒ½æµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **é¢„ç”Ÿäº§ç¯å¢ƒ**: æ€§èƒ½æµ‹è¯•å’Œä¸Šçº¿å‰éªŒè¯
- **ç”Ÿäº§ç¯å¢ƒ**: çº¿ä¸Šç›‘æ§å’Œå›å½’æµ‹è¯•

## æµ‹è¯•èŒƒå›´

### åŠŸèƒ½æ¨¡å—è¦†ç›–
| æ¨¡å— | æµ‹è¯•ç±»å‹ | ä¼˜å…ˆçº§ | è´Ÿè´£äºº |
|------|----------|--------|--------|
| ä¼šå‘˜ä¿¡æ¯ç®¡ç† | å•å…ƒ+é›†æˆ+æ¥å£ | P0 | æµ‹è¯•å·¥ç¨‹å¸ˆA |
| ç§¯åˆ†ç®¡ç†ç³»ç»Ÿ | å•å…ƒ+é›†æˆ+æ¥å£+æ€§èƒ½ | P0 | æµ‹è¯•å·¥ç¨‹å¸ˆB |
| ç­‰çº§ç®¡ç†ç³»ç»Ÿ | å•å…ƒ+é›†æˆ+æ¥å£ | P0 | æµ‹è¯•å·¥ç¨‹å¸ˆA |
| æƒç›Šç®¡ç†ç³»ç»Ÿ | å•å…ƒ+é›†æˆ+æ¥å£ | P1 | æµ‹è¯•å·¥ç¨‹å¸ˆC |
| æ´»åŠ¨ç®¡ç†ç³»ç»Ÿ | é›†æˆ+æ¥å£ | P1 | æµ‹è¯•å·¥ç¨‹å¸ˆC |
| æ•°æ®ç»Ÿè®¡åˆ†æ | é›†æˆ+æ¥å£ | P2 | æµ‹è¯•å·¥ç¨‹å¸ˆB |

### æµ‹è¯•ç”¨ä¾‹åˆ†ç±»
- **æ­£å¸¸æµç¨‹**: éªŒè¯æ ‡å‡†ä¸šåŠ¡æµç¨‹çš„æ­£ç¡®æ‰§è¡Œ
- **å¼‚å¸¸æµç¨‹**: éªŒè¯é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæ¡ä»¶
- **è¾¹ç•Œæµ‹è¯•**: éªŒè¯ä¸´ç•Œå€¼å’Œæé™æƒ…å†µ
- **å¹¶å‘æµ‹è¯•**: éªŒè¯å¤šç”¨æˆ·åŒæ—¶æ“ä½œçš„æ­£ç¡®æ€§
- **æ•°æ®ä¸€è‡´æ€§**: éªŒè¯è·¨è¡¨æ•°æ®çš„ä¸€è‡´æ€§ç»´æŠ¤

## å•å…ƒæµ‹è¯•è®¡åˆ’

### 1. ä¼šå‘˜æœåŠ¡æµ‹è¯• (test_member_service.py)

#### æµ‹è¯•ç±»: TestMemberService
```python
class TestMemberService:
    """ä¼šå‘˜æœåŠ¡å•å…ƒæµ‹è¯•"""
    
    def test_create_member_success(self):
        """æµ‹è¯•æˆåŠŸåˆ›å»ºä¼šå‘˜"""
        # æµ‹è¯•æ•°æ®å‡†å¤‡
        # æ‰§è¡Œåˆ›å»ºæ“ä½œ
        # éªŒè¯ç»“æœæ­£ç¡®æ€§
        
    def test_create_member_duplicate_user(self):
        """æµ‹è¯•é‡å¤ç”¨æˆ·åˆ›å»ºä¼šå‘˜å¤±è´¥"""
        
    def test_get_member_profile_success(self):
        """æµ‹è¯•è·å–ä¼šå‘˜ä¿¡æ¯æˆåŠŸ"""
        
    def test_get_member_profile_not_found(self):
        """æµ‹è¯•è·å–ä¸å­˜åœ¨ä¼šå‘˜ä¿¡æ¯"""
        
    def test_update_member_info_success(self):
        """æµ‹è¯•æ›´æ–°ä¼šå‘˜ä¿¡æ¯æˆåŠŸ"""
        
    def test_calculate_member_level_upgrade(self):
        """æµ‹è¯•ä¼šå‘˜ç­‰çº§è®¡ç®—å’Œå‡çº§"""
        
    def test_member_level_boundary_values(self):
        """æµ‹è¯•ç­‰çº§è¾¹ç•Œå€¼è®¡ç®—"""
```

#### å…³é”®æµ‹è¯•åœºæ™¯
| æµ‹è¯•åœºæ™¯ | è¾“å…¥æ¡ä»¶ | é¢„æœŸç»“æœ | éªŒè¯ç‚¹ |
|----------|----------|----------|--------|
| æ–°ç”¨æˆ·æ³¨å†Œæˆä¸ºä¼šå‘˜ | valid_user_id | åˆ›å»ºæˆåŠŸï¼Œåˆå§‹ç­‰çº§ä¸º1 | member_id, level_id=1 |
| é‡å¤ç”¨æˆ·æ³¨å†Œ | existing_user_id | æŠ›å‡ºå¼‚å¸¸ | DuplicateError |
| æ¶ˆè´¹é‡‘é¢è¾¾åˆ°å‡çº§æ¡ä»¶ | total_spent=500 | ç­‰çº§è‡ªåŠ¨å‡çº§åˆ°é“œç‰Œ | level_id=2 |
| æ¶ˆè´¹é‡‘é¢è¾¹ç•Œæµ‹è¯• | total_spent=499.99 | ä¿æŒå½“å‰ç­‰çº§ | level_id=1 |

### 2. ç§¯åˆ†æœåŠ¡æµ‹è¯• (test_point_service.py)

#### æµ‹è¯•ç±»: TestPointService
```python
class TestPointService:
    """ç§¯åˆ†æœåŠ¡å•å…ƒæµ‹è¯•"""
    
    def test_earn_points_purchase_success(self):
        """æµ‹è¯•è´­ç‰©è·å¾—ç§¯åˆ†æˆåŠŸ"""
        
    def test_earn_points_review_success(self):
        """æµ‹è¯•è¯„ä»·è·å¾—ç§¯åˆ†æˆåŠŸ"""
        
    def test_use_points_success(self):
        """æµ‹è¯•ä½¿ç”¨ç§¯åˆ†æˆåŠŸ"""
        
    def test_use_points_insufficient_balance(self):
        """æµ‹è¯•ç§¯åˆ†ä½™é¢ä¸è¶³"""
        
    def test_points_expiry_calculation(self):
        """æµ‹è¯•ç§¯åˆ†è¿‡æœŸè®¡ç®—"""
        
    def test_points_freeze_and_unfreeze(self):
        """æµ‹è¯•ç§¯åˆ†å†»ç»“å’Œè§£å†»"""
        
    def test_points_fifo_usage(self):
        """æµ‹è¯•ç§¯åˆ†FIFOä½¿ç”¨é¡ºåº"""
```

#### ç§¯åˆ†è®¡ç®—å‡†ç¡®æ€§æµ‹è¯•
| äº‹ä»¶ç±»å‹ | è¾“å…¥å‚æ•° | ç§¯åˆ†è§„åˆ™ | é¢„æœŸç§¯åˆ† | éªŒè¯ç‚¹ |
|----------|----------|----------|----------|--------|
| PURCHASE | order_amount=100 | 1å…ƒ=1ç§¯åˆ† | +100ç§¯åˆ† | ç§¯åˆ†ä½™é¢å¢åŠ  |
| REVIEW | product_id=123 | å›ºå®š10ç§¯åˆ† | +10ç§¯åˆ† | ç§¯åˆ†äº¤æ˜“è®°å½• |
| USE | use_points=50 | 100ç§¯åˆ†=1å…ƒ | -50ç§¯åˆ† | ç§¯åˆ†ä½™é¢å‡å°‘ |
| EXPIRE | expiry_date=today | è¿‡æœŸå¤„ç† | è¿‡æœŸç§¯åˆ†æ¸…é›¶ | è¿‡æœŸç§¯åˆ†ç»Ÿè®¡ |

### 3. æƒç›ŠæœåŠ¡æµ‹è¯• (test_benefit_service.py)

#### æµ‹è¯•ç±»: TestBenefitService  
```python
class TestBenefitService:
    """æƒç›ŠæœåŠ¡å•å…ƒæµ‹è¯•"""
    
    def test_get_available_benefits_by_level(self):
        """æµ‹è¯•æŒ‰ç­‰çº§è·å–å¯ç”¨æƒç›Š"""
        
    def test_calculate_discount_success(self):
        """æµ‹è¯•æŠ˜æ‰£è®¡ç®—æˆåŠŸ"""
        
    def test_use_benefit_success(self):
        """æµ‹è¯•ä½¿ç”¨æƒç›ŠæˆåŠŸ"""
        
    def test_benefit_usage_limit_check(self):
        """æµ‹è¯•æƒç›Šä½¿ç”¨æ¬¡æ•°é™åˆ¶"""
        
    def test_benefit_eligibility_check(self):
        """æµ‹è¯•æƒç›Šé€‚ç”¨æ€§æ£€æŸ¥"""
```

## é›†æˆæµ‹è¯•è®¡åˆ’

### 1. æ•°æ®åº“é›†æˆæµ‹è¯• (test_database_integration.py)

#### æµ‹è¯•åœºæ™¯
```python
class TestDatabaseIntegration:
    """æ•°æ®åº“é›†æˆæµ‹è¯•"""
    
    def test_member_creation_with_transaction(self):
        """æµ‹è¯•äº‹åŠ¡ä¸­åˆ›å»ºä¼šå‘˜çš„å®Œæ•´æ€§"""
        
    def test_point_transaction_consistency(self):
        """æµ‹è¯•ç§¯åˆ†äº¤æ˜“çš„æ•°æ®ä¸€è‡´æ€§"""
        
    def test_level_upgrade_cascade_updates(self):
        """æµ‹è¯•ç­‰çº§å‡çº§çš„çº§è”æ›´æ–°"""
        
    def test_foreign_key_constraints(self):
        """æµ‹è¯•å¤–é”®çº¦æŸçš„æœ‰æ•ˆæ€§"""
        
    def test_trigger_functionality(self):
        """æµ‹è¯•æ•°æ®åº“è§¦å‘å™¨åŠŸèƒ½"""
```

### 2. ç¼“å­˜é›†æˆæµ‹è¯• (test_cache_integration.py)

#### æµ‹è¯•åœºæ™¯
```python
class TestCacheIntegration:
    """ç¼“å­˜é›†æˆæµ‹è¯•"""
    
    def test_member_info_cache_hit(self):
        """æµ‹è¯•ä¼šå‘˜ä¿¡æ¯ç¼“å­˜å‘½ä¸­"""
        
    def test_cache_invalidation_on_update(self):
        """æµ‹è¯•æ•°æ®æ›´æ–°æ—¶ç¼“å­˜å¤±æ•ˆ"""
        
    def test_cache_warm_up(self):
        """æµ‹è¯•ç¼“å­˜é¢„çƒ­åŠŸèƒ½"""
        
    def test_cache_fallback_mechanism(self):
        """æµ‹è¯•ç¼“å­˜æ•…éšœæ—¶çš„é™çº§æœºåˆ¶"""
```

### 3. æ¶ˆæ¯é˜Ÿåˆ—é›†æˆæµ‹è¯• (test_mq_integration.py)

#### æµ‹è¯•åœºæ™¯
```python
class TestMQIntegration:
    """æ¶ˆæ¯é˜Ÿåˆ—é›†æˆæµ‹è¯•"""
    
    def test_level_upgrade_event_publishing(self):
        """æµ‹è¯•ç­‰çº§å‡çº§äº‹ä»¶å‘å¸ƒ"""
        
    def test_points_earned_event_processing(self):
        """æµ‹è¯•ç§¯åˆ†è·å¾—äº‹ä»¶å¤„ç†"""
        
    def test_event_retry_mechanism(self):
        """æµ‹è¯•äº‹ä»¶é‡è¯•æœºåˆ¶"""
        
    def test_dead_letter_queue_handling(self):
        """æµ‹è¯•æ­»ä¿¡é˜Ÿåˆ—å¤„ç†"""
```

## APIæ¥å£æµ‹è¯•è®¡åˆ’

### 1. ä¼šå‘˜ä¿¡æ¯APIæµ‹è¯•

#### GET /api/v1/member-system/profile
| æµ‹è¯•åœºæ™¯ | è¯·æ±‚å‚æ•° | é¢„æœŸçŠ¶æ€ç  | é¢„æœŸå“åº” | éªŒè¯ç‚¹ |
|----------|----------|------------|----------|--------|
| æ­£å¸¸è·å–ä¼šå‘˜ä¿¡æ¯ | valid_token | 200 | å®Œæ•´ä¼šå‘˜ä¿¡æ¯ | æ•°æ®å®Œæ•´æ€§ |
| æœªç™»å½•ç”¨æˆ·è®¿é—® | no_token | 401 | æœªæˆæƒé”™è¯¯ | è®¤è¯æ£€æŸ¥ |
| æ— æ•ˆToken | invalid_token | 401 | Tokenæ— æ•ˆ | TokenéªŒè¯ |
| ä¼šå‘˜ä¸å­˜åœ¨ | valid_token(no_member) | 404 | ä¼šå‘˜ä¸å­˜åœ¨ | ä¸šåŠ¡é€»è¾‘ |

#### POST /api/v1/member-system/points/use
| æµ‹è¯•åœºæ™¯ | è¯·æ±‚ä½“ | é¢„æœŸçŠ¶æ€ç  | é¢„æœŸå“åº” | éªŒè¯ç‚¹ |
|----------|--------|------------|----------|--------|
| æ­£å¸¸ä½¿ç”¨ç§¯åˆ† | {points: 100, order_amount: 200} | 200 | ä½¿ç”¨æˆåŠŸ | ç§¯åˆ†æ‰£å‡ |
| ç§¯åˆ†ä¸è¶³ | {points: 1000, order_amount: 200} | 409 | ä½™é¢ä¸è¶³ | ä¸šåŠ¡æ ¡éªŒ |
| å‚æ•°é”™è¯¯ | {points: -100} | 400 | å‚æ•°é”™è¯¯ | è¾“å…¥éªŒè¯ |
| è¶…è¿‡ä½¿ç”¨é™åˆ¶ | {points: 150, order_amount: 200} | 400 | è¶…è¿‡50%é™åˆ¶ | ä¸šåŠ¡è§„åˆ™ |

### 2. APIæ€§èƒ½æµ‹è¯•
```python
class TestAPIPerformance:
    """APIæ€§èƒ½æµ‹è¯•"""
    
    def test_member_profile_response_time(self):
        """æµ‹è¯•ä¼šå‘˜ä¿¡æ¯æŸ¥è¯¢å“åº”æ—¶é—´"""
        # ç›®æ ‡: <200ms
        
    def test_points_calculation_performance(self):
        """æµ‹è¯•ç§¯åˆ†è®¡ç®—æ€§èƒ½"""
        # ç›®æ ‡: <100ms
        
    def test_concurrent_point_usage(self):
        """æµ‹è¯•å¹¶å‘ç§¯åˆ†ä½¿ç”¨æ€§èƒ½"""
        # æ¨¡æ‹Ÿ100å¹¶å‘ç”¨æˆ·
        
    def test_api_throughput(self):
        """æµ‹è¯•APIååé‡"""
        # ç›®æ ‡: >1000 QPS
```

## ç«¯åˆ°ç«¯æµ‹è¯•è®¡åˆ’

### 1. å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•

#### åœºæ™¯1: æ–°ç”¨æˆ·å®Œæ•´ä½“éªŒæµç¨‹
```gherkin
Feature: æ–°ç”¨æˆ·ä¼šå‘˜ä½“éªŒå®Œæ•´æµç¨‹

  Scenario: ç”¨æˆ·ä»æ³¨å†Œåˆ°æˆä¸ºé“¶ç‰Œä¼šå‘˜
    Given æ–°ç”¨æˆ·å®Œæˆæ³¨å†Œ
    When ç”¨æˆ·è‡ªåŠ¨æˆä¸ºæ³¨å†Œä¼šå‘˜
    Then ä¼šå‘˜ç­‰çº§ä¸º"æ³¨å†Œä¼šå‘˜"
    And ç§¯åˆ†ä½™é¢ä¸º0
    
    When ç”¨æˆ·é¦–æ¬¡è´­ç‰©æ¶ˆè´¹300å…ƒ
    Then è·å¾—300ç§¯åˆ†
    And ç´¯è®¡æ¶ˆè´¹ä¸º300å…ƒ
    And ä¼šå‘˜ç­‰çº§ä»ä¸º"æ³¨å†Œä¼šå‘˜"
    
    When ç”¨æˆ·ç»§ç»­è´­ç‰©æ¶ˆè´¹250å…ƒ
    Then è·å¾—250ç§¯åˆ†
    And ç´¯è®¡æ¶ˆè´¹ä¸º550å…ƒ
    And ä¼šå‘˜ç­‰çº§å‡çº§ä¸º"é“œç‰Œä¼šå‘˜"
    And äº«å—95æŠ˜ä¼˜æƒ 
    
    When ç”¨æˆ·å†™å•†å“è¯„ä»·
    Then è·å¾—10ç§¯åˆ†
    And ç§¯åˆ†ä½™é¢ä¸º560ç§¯åˆ†
    
    When ç”¨æˆ·ç»§ç»­æ¶ˆè´¹è‡³2000å…ƒ
    Then ä¼šå‘˜ç­‰çº§å‡çº§ä¸º"é“¶ç‰Œä¼šå‘˜"
    And äº«å—9æŠ˜ä¼˜æƒ å’Œå…é‚®æƒç›Š
```

#### åœºæ™¯2: ç§¯åˆ†ä½¿ç”¨å’Œè¿‡æœŸå¤„ç†
```gherkin
Feature: ç§¯åˆ†å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†

  Scenario: ç§¯åˆ†è·å¾—ã€ä½¿ç”¨å’Œè¿‡æœŸå¤„ç†
    Given é“¶ç‰Œä¼šå‘˜æœ‰1000ç§¯åˆ†å³å°†è¿‡æœŸ
    When ç”¨æˆ·ä¸‹å•è´­ä¹°å•†å“200å…ƒ
    And é€‰æ‹©ä½¿ç”¨100ç§¯åˆ†æŠµæ‰£
    Then è®¢å•é‡‘é¢å˜ä¸º199å…ƒ
    And ç§¯åˆ†ä½™é¢å‡å°‘100
    And ä¼˜å…ˆæ‰£é™¤å³å°†è¿‡æœŸçš„ç§¯åˆ†
    
    When ç§¯åˆ†åˆ°æœŸæ—¥åˆ°è¾¾
    Then è¿‡æœŸç§¯åˆ†è‡ªåŠ¨æ¸…é›¶
    And å‘é€è¿‡æœŸæé†’é€šçŸ¥
```

### 2. å¼‚å¸¸åœºæ™¯æµ‹è¯•

#### æ•°æ®ä¸€è‡´æ€§æµ‹è¯•
```python
class TestDataConsistency:
    """æ•°æ®ä¸€è‡´æ€§æµ‹è¯•"""
    
    def test_concurrent_point_operations(self):
        """å¹¶å‘ç§¯åˆ†æ“ä½œä¸€è‡´æ€§æµ‹è¯•"""
        # åŒæ—¶è¿›è¡Œç§¯åˆ†è·å¾—å’Œä½¿ç”¨æ“ä½œ
        # éªŒè¯æœ€ç»ˆç§¯åˆ†ä½™é¢æ­£ç¡®
        
    def test_level_upgrade_during_point_usage(self):
        """ç­‰çº§å‡çº§è¿‡ç¨‹ä¸­ä½¿ç”¨ç§¯åˆ†çš„ä¸€è‡´æ€§"""
        # æ¨¡æ‹Ÿç­‰çº§å‡çº§çš„åŒæ—¶ä½¿ç”¨ç§¯åˆ†
        # éªŒè¯æ•°æ®ä¸€è‡´æ€§
        
    def test_rollback_on_payment_failure(self):
        """æ”¯ä»˜å¤±è´¥æ—¶çš„å›æ»šæµ‹è¯•"""
        # æ¨¡æ‹Ÿæ”¯ä»˜å¤±è´¥åœºæ™¯
        # éªŒè¯ç§¯åˆ†å’Œç­‰çº§æ•°æ®å›æ»š
```

## æ€§èƒ½æµ‹è¯•è®¡åˆ’

### 1. è´Ÿè½½æµ‹è¯•

#### æµ‹è¯•åœºæ™¯è®¾è®¡
| æµ‹è¯•ç±»å‹ | å¹¶å‘ç”¨æˆ·æ•° | æŒç»­æ—¶é—´ | ç›®æ ‡TPS | å“åº”æ—¶é—´è¦æ±‚ |
|----------|------------|----------|---------|-------------|
| åŸºå‡†æµ‹è¯• | 100 | 10åˆ†é’Ÿ | 500 | 95%<200ms |
| è´Ÿè½½æµ‹è¯• | 1000 | 30åˆ†é’Ÿ | 1000 | 95%<500ms |
| å‹åŠ›æµ‹è¯• | 2000 | 15åˆ†é’Ÿ | 1500 | 95%<1s |
| å³°å€¼æµ‹è¯• | 5000 | 5åˆ†é’Ÿ | 2000 | ä¸å´©æºƒ |

#### å…³é”®æ¥å£æ€§èƒ½æŒ‡æ ‡
```python
PERFORMANCE_REQUIREMENTS = {
    "GET /member-system/profile": {
        "response_time_95th": 200,  # ms
        "throughput": 1000,  # QPS
        "error_rate": 0.01   # 1%
    },
    "POST /member-system/points/use": {
        "response_time_95th": 300,  # ms
        "throughput": 500,   # QPS
        "error_rate": 0.005  # 0.5%
    },
    "GET /member-system/points/transactions": {
        "response_time_95th": 500,  # ms
        "throughput": 800,   # QPS
        "error_rate": 0.01   # 1%
    }
}
```

### 2. ç¨³å®šæ€§æµ‹è¯•

#### é•¿æ—¶é—´è¿è¡Œæµ‹è¯•
```python
class TestStability:
    """ç¨³å®šæ€§æµ‹è¯•"""
    
    def test_24_hour_continuous_operation(self):
        """24å°æ—¶è¿ç»­è¿è¡Œæµ‹è¯•"""
        # æ¨¡æ‹Ÿæ­£å¸¸ä¸šåŠ¡è´Ÿè½½
        # æŒç»­24å°æ—¶è¿è¡Œ
        # ç›‘æ§å†…å­˜æ³„æ¼å’Œæ€§èƒ½è¡°å‡
        
    def test_database_connection_pool_stability(self):
        """æ•°æ®åº“è¿æ¥æ± ç¨³å®šæ€§æµ‹è¯•"""
        # é•¿æ—¶é—´é«˜å¹¶å‘æ•°æ®åº“æ“ä½œ
        # éªŒè¯è¿æ¥æ± ä¸ä¼šè€—å°½
        
    def test_cache_stability_under_load(self):
        """ç¼“å­˜ç³»ç»Ÿè´Ÿè½½ç¨³å®šæ€§æµ‹è¯•"""
        # é«˜é¢‘ç¼“å­˜è¯»å†™æ“ä½œ
        # éªŒè¯ç¼“å­˜ç³»ç»Ÿç¨³å®šæ€§
```

## å®‰å…¨æµ‹è¯•è®¡åˆ’

### 1. æƒé™æ§åˆ¶æµ‹è¯•

#### æµ‹è¯•åœºæ™¯
```python
class TestSecurity:
    """å®‰å…¨æµ‹è¯•"""
    
    def test_unauthorized_access_prevention(self):
        """æµ‹è¯•æœªæˆæƒè®¿é—®é˜²æŠ¤"""
        # æ— Tokenè®¿é—®ä¼šå‘˜ä¿¡æ¯
        # éªŒè¯è¿”å›401é”™è¯¯
        
    def test_cross_user_data_access_prevention(self):
        """æµ‹è¯•è·¨ç”¨æˆ·æ•°æ®è®¿é—®é˜²æŠ¤"""
        # ç”¨æˆ·Aå°è¯•è®¿é—®ç”¨æˆ·Bçš„ä¼šå‘˜ä¿¡æ¯
        # éªŒè¯è¿”å›403é”™è¯¯
        
    def test_admin_permission_validation(self):
        """æµ‹è¯•ç®¡ç†å‘˜æƒé™éªŒè¯"""
        # æ™®é€šç”¨æˆ·å°è¯•æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ
        # éªŒè¯æƒé™æ£€æŸ¥æœ‰æ•ˆ
        
    def test_sql_injection_prevention(self):
        """æµ‹è¯•SQLæ³¨å…¥é˜²æŠ¤"""
        # è¾“å…¥æ¶æ„SQLå‚æ•°
        # éªŒè¯ç³»ç»Ÿå®‰å…¨é˜²æŠ¤
        
    def test_sensitive_data_encryption(self):
        """æµ‹è¯•æ•æ„Ÿæ•°æ®åŠ å¯†"""
        # éªŒè¯ç”Ÿæ—¥ã€æ‰‹æœºå·ç­‰æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨
```

### 2. æ•°æ®å®‰å…¨æµ‹è¯•

#### æµ‹è¯•ç”¨ä¾‹
| æµ‹è¯•åœºæ™¯ | è¾“å…¥æ•°æ® | éªŒè¯ç‚¹ | é¢„æœŸç»“æœ |
|----------|----------|--------|----------|
| æ•æ„Ÿä¿¡æ¯æŸ¥è¯¢ | æ­£å¸¸ç”¨æˆ·æŸ¥çœ‹ä¼šå‘˜ä¿¡æ¯ | æ•æ„Ÿå­—æ®µæ˜¯å¦è„±æ• | æ‰‹æœºå·æ˜¾ç¤ºä¸º138****0000 |
| ç®¡ç†å‘˜æŸ¥è¯¢ | ç®¡ç†å‘˜æŸ¥çœ‹ä¼šå‘˜ä¿¡æ¯ | æ˜¯å¦æœ‰å®Œæ•´æ•æ„Ÿä¿¡æ¯ | æ˜¾ç¤ºå®Œæ•´æ‰‹æœºå· |
| æ—¥å¿—è®°å½• | APIè°ƒç”¨äº§ç”Ÿçš„æ—¥å¿— | æ•æ„Ÿä¿¡æ¯æ˜¯å¦è®°å½• | æ—¥å¿—ä¸­ä¸åŒ…å«å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ |

## æµ‹è¯•æ•°æ®å‡†å¤‡

### 1. åŸºç¡€æµ‹è¯•æ•°æ®

#### ä¼šå‘˜ç­‰çº§æ•°æ®
```sql
INSERT INTO member_levels (level_name, min_points, discount_rate, benefits) VALUES
('æ³¨å†Œä¼šå‘˜', 0, 1.000, '{"point_multiplier": 1.0, "free_shipping_threshold": 99}'),
('é“œç‰Œä¼šå‘˜', 500, 0.950, '{"point_multiplier": 1.2, "free_shipping_threshold": 79}'),
('é“¶ç‰Œä¼šå‘˜', 2000, 0.900, '{"point_multiplier": 1.5, "free_shipping_threshold": 59}'),
('é‡‘ç‰Œä¼šå‘˜', 5000, 0.850, '{"point_multiplier": 1.8, "free_shipping_threshold": 39}'),
('é’»çŸ³ä¼šå‘˜', 10000, 0.800, '{"point_multiplier": 2.0, "free_shipping_threshold": 0}');
```

#### æµ‹è¯•ä¼šå‘˜æ•°æ®
```sql
INSERT INTO member_profiles (member_code, user_id, level_id, total_spent, join_date, status) VALUES
('M20250917001', 1001, 1, 0.00, '2025-09-17', 1),           -- æ–°æ³¨å†Œä¼šå‘˜
('M20250917003', 1003, 3, 2500.00, '2025-07-20', 1),       -- é“¶ç‰Œä¼šå‘˜  
('M20250917004', 1004, 4, 6000.00, '2025-06-10', 1),       -- é‡‘ç‰Œä¼šå‘˜
('M20250917005', 1005, 5, 15000.00, '2025-05-01', 1);      -- é’»çŸ³ä¼šå‘˜
```

#### ç§¯åˆ†è´¦æˆ·æµ‹è¯•æ•°æ®
```sql
INSERT INTO member_points (user_id, level_id, current_points, total_earned, total_used) VALUES
(1001, 1, 0, 0, 0),           -- æ–°æ³¨å†Œä¼šå‘˜
(1002, 2, 750, 1000, 250),    -- é“œç‰Œä¼šå‘˜
(1003, 3, 1200, 3000, 1800),  -- é“¶ç‰Œä¼šå‘˜
(1004, 4, 3000, 8000, 5000),  -- é‡‘ç‰Œä¼šå‘˜
(1005, 5, 5000, 20000, 15000); -- é’»çŸ³ä¼šå‘˜
```

### 2. æ€§èƒ½æµ‹è¯•æ•°æ®

#### å¤§æ•°æ®é‡å‡†å¤‡è„šæœ¬
```python
async def prepare_performance_test_data():
    """å‡†å¤‡æ€§èƒ½æµ‹è¯•æ•°æ®"""
    
    # åˆ›å»º10ä¸‡æµ‹è¯•ä¼šå‘˜
    members_data = []
    for i in range(100000):
        member_data = {
            "member_code": f"M2025{i:08d}",
            "user_id": 10000 + i,
            "level_id": random.randint(1, 5),
            "total_spent": random.uniform(0, 20000),
            "available_points": random.randint(0, 5000)
        }
        members_data.append(member_data)
    
    await batch_insert_member_profiles(members_data)
    
    # åˆ›å»º100ä¸‡ç§¯åˆ†äº¤æ˜“è®°å½•
    transactions_data = []
    for i in range(1000000):
        transaction_data = {
            "user_id": random.randint(10001, 110000),
            "transaction_type": random.choice(["earn", "use", "expire"]),
            "points_change": random.randint(-1000, 1000),
            "reference_type": random.choice(["order", "review", "manual"]),
            "status": "completed",
            "created_at": fake.date_time_between("-1y", "now")
        }
        transactions_data.append(transaction_data)
    
    await batch_insert_point_transactions(transactions_data)
```

## æµ‹è¯•æ‰§è¡Œè®¡åˆ’

### 1. æµ‹è¯•é˜¶æ®µå®‰æ’

| é˜¶æ®µ | æ—¶é—´å®‰æ’ | æµ‹è¯•å†…å®¹ | è´Ÿè´£äºº | é€šè¿‡æ ‡å‡† |
|------|----------|----------|--------|----------|
| ç¬¬1å‘¨ | å•å…ƒæµ‹è¯• | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æµ‹è¯• | å¼€å‘å·¥ç¨‹å¸ˆ | ä»£ç è¦†ç›–ç‡â‰¥90% |
| ç¬¬2å‘¨ | é›†æˆæµ‹è¯• | æ¨¡å—é—´é›†æˆæµ‹è¯• | æµ‹è¯•å·¥ç¨‹å¸ˆ | æ‰€æœ‰é›†æˆç”¨ä¾‹é€šè¿‡ |
| ç¬¬3å‘¨ | æ¥å£æµ‹è¯• | APIåŠŸèƒ½å’Œæ€§èƒ½æµ‹è¯• | æµ‹è¯•å·¥ç¨‹å¸ˆ | æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡ |
| ç¬¬4å‘¨ | ç«¯åˆ°ç«¯æµ‹è¯• | å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯• | æµ‹è¯•å›¢é˜Ÿ | æ ¸å¿ƒæµç¨‹æ— é˜»å¡é—®é¢˜ |
| ç¬¬5å‘¨ | æ€§èƒ½æµ‹è¯• | è´Ÿè½½å’Œå‹åŠ›æµ‹è¯• | æ€§èƒ½å·¥ç¨‹å¸ˆ | æ€§èƒ½æŒ‡æ ‡ç¬¦åˆè¦æ±‚ |
| ç¬¬6å‘¨ | å®‰å…¨æµ‹è¯• | å®‰å…¨æ¼æ´æ‰«æ | å®‰å…¨å·¥ç¨‹å¸ˆ | æ— é«˜å±å®‰å…¨é—®é¢˜ |

### 2. æµ‹è¯•ç¯å¢ƒå‡†å¤‡

#### æµ‹è¯•ç¯å¢ƒé…ç½®
```yaml
# æµ‹è¯•ç¯å¢ƒDockeré…ç½®
version: '3.8'
services:
  member-system-test:
    image: member-system:test
    environment:
      - ENV=test
      - DATABASE_URL=mysql://test_user:test_pass@mysql:3306/member_test
      - REDIS_URL=redis://redis:6379/1
      - LOG_LEVEL=DEBUG
    depends_on:
      - mysql
      - redis
      
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_DATABASE: member_test
      MYSQL_USER: test_user
      MYSQL_PASSWORD: test_pass
      MYSQL_ROOT_PASSWORD: root_pass
    ports:
      - "3306:3306"
      
  redis:
    image: redis:6.0
    ports:
      - "6379:6379"
```

### 3. æµ‹è¯•å·¥å…·å’Œæ¡†æ¶

#### æµ‹è¯•æŠ€æœ¯æ ˆ
- **å•å…ƒæµ‹è¯•**: pytest + pytest-asyncio
- **APIæµ‹è¯•**: httpx + pytest
- **æ€§èƒ½æµ‹è¯•**: locust + pytest-benchmark  
- **æ•°æ®åº“æµ‹è¯•**: pytest-postgresql + factory-boy
- **Mockæ¡†æ¶**: pytest-mock + responses
- **è¦†ç›–ç‡å·¥å…·**: coverage.py
- **æµ‹è¯•æŠ¥å‘Š**: allure + pytest-html

#### æµ‹è¯•è„šæœ¬ç¤ºä¾‹
```python
# conftest.py - æµ‹è¯•é…ç½®
@pytest.fixture
async def test_db():
    """æµ‹è¯•æ•°æ®åº“fixture"""
    async with create_test_database() as db:
        yield db

@pytest.fixture
async def test_member():
    """æµ‹è¯•ä¼šå‘˜fixture"""
    member_data = {
        "user_id": 1001,
        "level_id": 1,
        "total_spent": 0,
        "available_points": 0
    }
    return await create_test_member(member_data)

# æ€§èƒ½æµ‹è¯•è„šæœ¬
class MemberSystemLoadTest(HttpUser):
    wait_time = between(1, 3)
    
    @task(3)
    def get_member_profile(self):
        self.client.get("/api/v1/member-system/profile")
        
    @task(1)  
    def use_points(self):
        self.client.post("/api/v1/member-system/points/use", json={
            "points": 100,
            "order_amount": 200
        })
```

## è´¨é‡é—¨ç¦æ ‡å‡†

### 1. åŠŸèƒ½è´¨é‡æ ‡å‡†
- [ ] æ‰€æœ‰P0çº§åˆ«æµ‹è¯•ç”¨ä¾‹100%é€šè¿‡
- [ ] æ‰€æœ‰P1çº§åˆ«æµ‹è¯•ç”¨ä¾‹95%é€šè¿‡
- [ ] æ ¸å¿ƒä¸šåŠ¡æµç¨‹ç«¯åˆ°ç«¯æµ‹è¯•é€šè¿‡
- [ ] æ•°æ®ä¸€è‡´æ€§æµ‹è¯•é€šè¿‡
- [ ] å¼‚å¸¸å¤„ç†æµ‹è¯•é€šè¿‡

### 2. æ€§èƒ½è´¨é‡æ ‡å‡†  
- [ ] APIå“åº”æ—¶é—´95%åˆ†ä½æ•°<200ms
- [ ] ç³»ç»Ÿæ”¯æŒ1000å¹¶å‘ç”¨æˆ·
- [ ] 24å°æ—¶ç¨³å®šæ€§æµ‹è¯•é€šè¿‡
- [ ] å†…å­˜ä½¿ç”¨å¢é•¿<10%/å°æ—¶
- [ ] CPUä½¿ç”¨ç‡<70%

### 3. å®‰å…¨è´¨é‡æ ‡å‡†
- [ ] æƒé™æ§åˆ¶æµ‹è¯•100%é€šè¿‡
- [ ] æ•æ„Ÿæ•°æ®åŠ å¯†æµ‹è¯•é€šè¿‡
- [ ] SQLæ³¨å…¥é˜²æŠ¤æµ‹è¯•é€šè¿‡
- [ ] XSSæ”»å‡»é˜²æŠ¤æµ‹è¯•é€šè¿‡
- [ ] å®‰å…¨æ‰«ææ— é«˜å±æ¼æ´

### 4. ä»£ç è´¨é‡æ ‡å‡†
- [ ] å•å…ƒæµ‹è¯•ä»£ç è¦†ç›–ç‡â‰¥90%
- [ ] é›†æˆæµ‹è¯•è¦†ç›–æ‰€æœ‰APIæ¥å£
- [ ] ä»£ç é™æ€æ‰«æé€šè¿‡
- [ ] ä»£ç Reviewå®Œæˆç‡100%

## ç¼ºé™·ç®¡ç†

### 1. ç¼ºé™·åˆ†çº§æ ‡å‡†
| çº§åˆ« | æè¿° | å¤„ç†æ—¶é—´ | ä¿®å¤è¦æ±‚ |
|------|------|----------|----------|
| P0-é˜»å¡ | æ ¸å¿ƒåŠŸèƒ½ä¸å¯ç”¨ | 2å°æ—¶ | å¿…é¡»ä¿®å¤ |
| P1-ä¸¥é‡ | ä¸»è¦åŠŸèƒ½å¼‚å¸¸ | 1å¤© | å¿…é¡»ä¿®å¤ |
| P2-ä¸€èˆ¬ | æ¬¡è¦åŠŸèƒ½é—®é¢˜ | 3å¤© | å»ºè®®ä¿®å¤ |
| P3-è½»å¾® | ä¼˜åŒ–å»ºè®® | 1å‘¨ | å¯å»¶æœŸä¿®å¤ |

### 2. ç¼ºé™·è·Ÿè¸ªæµç¨‹
1. **å‘ç°é˜¶æ®µ**: æµ‹è¯•äººå‘˜å‘ç°å¹¶è®°å½•ç¼ºé™·
2. **ç¡®è®¤é˜¶æ®µ**: å¼€å‘äººå‘˜ç¡®è®¤ç¼ºé™·å¹¶è¯„ä¼°å½±å“
3. **ä¿®å¤é˜¶æ®µ**: å¼€å‘äººå‘˜ä¿®å¤ç¼ºé™·å¹¶æä¾›è¡¥ä¸
4. **éªŒè¯é˜¶æ®µ**: æµ‹è¯•äººå‘˜éªŒè¯ä¿®å¤æ•ˆæœ
5. **å…³é—­é˜¶æ®µ**: ç¡®è®¤ä¿®å¤åå…³é—­ç¼ºé™·

## æµ‹è¯•æŠ¥å‘Š

### 1. æµ‹è¯•æ‰§è¡ŒæŠ¥å‘Šæ¨¡æ¿
```
ä¼šå‘˜ç³»ç»Ÿæµ‹è¯•æ‰§è¡ŒæŠ¥å‘Š

æµ‹è¯•æ¦‚å†µ:
- æµ‹è¯•æ—¶é—´: 2025-09-17 ~ 2025-10-01
- æµ‹è¯•ç¯å¢ƒ: æµ‹è¯•ç¯å¢ƒv1.0
- æµ‹è¯•äººå‘˜: æµ‹è¯•å›¢é˜Ÿ(5äºº)

æµ‹è¯•ç»“æœç»Ÿè®¡:
- è®¡åˆ’ç”¨ä¾‹æ•°: 500
- æ‰§è¡Œç”¨ä¾‹æ•°: 498
- é€šè¿‡ç”¨ä¾‹æ•°: 485
- å¤±è´¥ç”¨ä¾‹æ•°: 13
- é˜»å¡ç”¨ä¾‹æ•°: 0
- ç”¨ä¾‹é€šè¿‡ç‡: 97.4%

ç¼ºé™·ç»Ÿè®¡:
- P0çº§ç¼ºé™·: 0ä¸ª
- P1çº§ç¼ºé™·: 2ä¸ª 
- P2çº§ç¼ºé™·: 8ä¸ª
- P3çº§ç¼ºé™·: 15ä¸ª
- ç¼ºé™·å¯†åº¦: 0.05ä¸ª/KLOC

è´¨é‡è¯„ä¼°:
- åŠŸèƒ½å®Œæ•´æ€§: 98%
- æ€§èƒ½è¾¾æ ‡ç‡: 100%  
- å®‰å…¨åˆè§„æ€§: 100%
- ä»£ç è¦†ç›–ç‡: 92%

ç»“è®º: ä¼šå‘˜ç³»ç»Ÿè´¨é‡è¾¾åˆ°ä¸Šçº¿æ ‡å‡†ï¼Œå»ºè®®è¿›å…¥ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ã€‚
```

è¿™ä¸ªå…¨é¢çš„æµ‹è¯•è®¡åˆ’ç¡®ä¿äº†ä¼šå‘˜ç³»ç»Ÿçš„è´¨é‡å’Œå¯é æ€§ï¼Œè¦†ç›–äº†åŠŸèƒ½ã€æ€§èƒ½ã€å®‰å…¨ç­‰å„ä¸ªæ–¹é¢çš„æµ‹è¯•éœ€æ±‚ã€‚
