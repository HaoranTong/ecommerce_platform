# 端到端测试 (E2E Tests)

本目录包含完整的用户场景测试，验证整个系统的端到端功能和业务流程。

## 测试覆盖范围

### 商品管理工作流
- `test_product_workflow_e2e.py` - 商品从创建到销售的完整生命周期测试

## 测试特点

端到端测试具有以下特征：
- **完整业务流程**：模拟真实用户操作场景
- **跨模块验证**：测试多个系统模块的协调工作
- **真实环境**：使用接近生产环境的配置
- **数据一致性**：验证整个流程的数据完整性

## 测试场景设计

### 商品工作流测试场景
1. **商品创建流程**
   - 管理员登录
   - 创建商品分类
   - 添加商品信息
   - 设置库存数量

2. **商品展示流程**
   - 用户浏览商品列表
   - 搜索特定商品
   - 查看商品详情

3. **购买流程**
   - 用户注册/登录
   - 添加商品到购物车
   - 下单结算
   - 库存扣减验证

4. **订单处理流程**
   - 订单状态更新
   - 库存同步检查
   - 通知发送验证

## 运行方式

```bash
# 运行所有E2E测试
pytest tests/e2e/

# 运行特定E2E测试
pytest tests/e2e/test_product_workflow_e2e.py

# 带详细输出和日志
pytest tests/e2e/ -v -s --log-cli-level=INFO

# 运行慢速测试（包含完整流程）
pytest tests/e2e/ -m "not slow" # 排除慢速测试
pytest tests/e2e/ -m "slow"     # 只运行慢速测试
```

## 测试环境要求

E2E测试需要：
- 完整的应用程序栈
- 数据库服务（可以是测试数据库）
- Redis服务（缓存和会话）
- 所有相关的微服务

## 测试数据管理

E2E测试的测试数据管理：
1. **测试前准备**：创建完整的测试数据集
2. **测试执行**：按照真实业务流程操作
3. **测试后清理**：保证测试环境的干净状态

## 性能考虑

由于E2E测试涉及完整流程，可能执行时间较长：
- 使用合适的超时设置
- 考虑并行执行策略
- 监控测试执行时间

## 新增E2E测试指南

1. **场景识别**：确定需要验证的完整业务流程
2. **用户故事**：编写详细的用户操作步骤
3. **数据准备**：准备测试所需的完整数据集
4. **流程实现**：按步骤实现自动化测试
5. **结果验证**：验证每个步骤的预期结果
6. **错误处理**：测试异常情况的处理